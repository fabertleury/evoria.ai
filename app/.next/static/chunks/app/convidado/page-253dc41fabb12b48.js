(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{1381:function(e,t,n){Promise.resolve().then(n.bind(n,2307))},2307:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var a=n(7437),s=n(2265),c=n(495),o=n(3102),i=n(7135),r=n(6264);function l(){let[e,t]=(0,s.useState)(""),[n,l]=(0,s.useState)(""),[u,d]=(0,s.useState)(""),[h,p]=(0,s.useState)(null),[f,m]=(0,s.useState)("feed"),[x,j]=(0,s.useState)(10),[v,y]=(0,s.useState)(""),[g,S]=(0,s.useState)(10),[C,w]=(0,s.useState)(30),[N,b]=(0,s.useState)(0),[I,T]=(0,s.useState)(0),[_,k]=(0,s.useState)(0),E=async()=>{let t=await fetch("".concat("http://localhost:8000/api","/guests"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e,displayName:n})}),a=await t.json();d(a.guest.id);let s=await (0,r.S)("/wallet?guestId=".concat(a.guest.id));b((await s.json()).balance||0)},O=async()=>{if(!h)return;let t="events/".concat(e,"/media/").concat(Date.now(),"_").concat(h.name),n=await fetch("".concat("http://localhost:8000/api","/storage/signed-upload"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,contentType:h.type})}),{url:a}=await n.json();await fetch(a,{method:"PUT",headers:{"Content-Type":h.type},body:h});let s=h.type.startsWith("image")?"image":h.type.startsWith("video")?"video":"audio",c=await fetch("".concat("http://localhost:8000/api","/media"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e,guestId:u,type:s,url:t})});y((await c.json()).media.id)},P=async()=>{let t=await fetch("".concat("http://localhost:8000/api","/payments/checkout"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:x,currency:"BRL",eventId:e,guestId:u})}),n=await t.json();n.url&&(window.location.href=n.url)},z=async()=>{let t=await (0,r.S)("/pricing?eventId=".concat(encodeURIComponent(e))),n=await t.json();T(n.feedPrice||0),k(n.screenPrice||0)};return(0,s.useEffect)(()=>{e&&z()},[e]),(0,a.jsxs)("main",{className:"p-8 space-y-6 max-w-xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Convidados"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i._,{children:"Evento"}),(0,a.jsx)(o.I,{value:e,onChange:e=>t(e.target.value),placeholder:"eventId"})]}),u&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:"\uD83E\uDE99"}),(0,a.jsxs)("div",{children:["Saldo: ",N," cr\xe9ditos"]}),(0,a.jsx)(c.z,{onClick:P,children:"Comprar cr\xe9ditos"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i._,{children:"Seu nome"}),(0,a.jsx)(o.I,{value:n,onChange:e=>l(e.target.value),placeholder:"Seu nome"}),(0,a.jsx)(c.z,{onClick:E,children:"Entrar no evento"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i._,{children:"M\xeddia"}),(0,a.jsx)(o.I,{type:"file",onChange:e=>{var t;return p((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(c.z,{onClick:O,children:"Enviar m\xeddia"}),(0,a.jsxs)("select",{value:f,onChange:e=>m(e.target.value),className:"border rounded px-2",children:[(0,a.jsx)("option",{value:"feed",children:"Feed"}),(0,a.jsx)("option",{value:"screen",children:"Tel\xe3o"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Pre\xe7o Feed: ",I," â€¢ Pre\xe7o Tel\xe3o: ",_]}),"screen"===f&&(0,a.jsxs)("div",{className:"flex gap-3 items-center mt-2",children:[(0,a.jsx)(i._,{children:"Cr\xe9ditos"}),(0,a.jsx)(o.I,{type:"number",value:g,onChange:e=>S(parseInt(e.target.value||"0"))}),(0,a.jsx)(i._,{children:"Dura\xe7\xe3o"}),(0,a.jsx)(o.I,{type:"number",value:C,onChange:e=>w(parseInt(e.target.value||"0"))}),(0,a.jsx)(c.z,{onClick:async()=>{v&&await fetch("".concat("http://localhost:8000/api","/screen/enqueue"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e,mediaId:v,guestId:u,durationSec:C,bidCredits:g})})},children:"Entrar no Tel\xe3o"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i._,{children:"Pagamento (BRL)"}),(0,a.jsx)(o.I,{type:"number",value:x,onChange:e=>j(parseInt(e.target.value||"0"))}),(0,a.jsx)(c.z,{onClick:P,children:"Comprar cr\xe9ditos \uD83E\uDE99"})]})]})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var a=n(7437);function s(e){let{className:t="",...n}=e;return(0,a.jsx)("button",{className:"px-4 py-2 rounded bg-black text-white ".concat(t),...n})}},3102:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var a=n(7437);function s(e){let{className:t="",...n}=e;return(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2 ".concat(t),...n})}},7135:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var a=n(7437);function s(e){let{className:t="",...n}=e;return(0,a.jsx)("label",{className:"text-sm font-medium ".concat(t),...n})}},6264:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});var a=n(5216);async function s(e,t){let n=(0,a.L)(),s={...(null==t?void 0:t.headers)||{},Authorization:n?"Bearer ".concat(n):""};return await fetch("".concat("http://localhost:8000/api").concat(e),{...t,headers:s})}},5216:function(e,t,n){"use strict";function a(){return localStorage.getItem("evoria_token")||""}function s(e){localStorage.setItem("evoria_token",e)}n.d(t,{L:function(){return a},o:function(){return s}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=1381)}),_N_E=e.O()}]);