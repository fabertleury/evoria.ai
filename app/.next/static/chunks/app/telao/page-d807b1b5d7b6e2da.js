(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[824],{2133:function(e,t,n){Promise.resolve().then(n.bind(n,9452))},9452:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var a=n(7437),s=n(2265),c=n(1180),i=n(3102),r=n(495);function l(){let[e,t]=(0,s.useState)(""),[n,l]=(0,s.useState)({queue:[],currentIndex:0}),o=n.queue[n.currentIndex],[d,u]=(0,s.useState)(""),[m,v]=(0,s.useState)("none"),x="http://localhost:8000/api".replace(/^"|"$/g,""),h=async e=>{try{var t,n;let a=await fetch("".concat(x,"/screen/state?eventId=").concat(encodeURIComponent(e)));if(!a.ok)return;let s=await a.json();(null==s?void 0:null===(t=s.state)||void 0===t?void 0:t.queue)&&"number"==typeof(null==s?void 0:null===(n=s.state)||void 0===n?void 0:n.currentIndex)&&l(s.state)}catch(e){}};(0,s.useEffect)(()=>{if(!e)return;h(e);let t=c.O.channel("screen_".concat(e)).on("postgres_changes",{event:"UPDATE",schema:"public",table:"broadcast_sessions",filter:"event_id=eq.".concat(e)},e=>{var t;let n=null==e?void 0:null===(t=e.new)||void 0===t?void 0:t.state;(null==n?void 0:n.queue)&&"number"==typeof(null==n?void 0:n.currentIndex)&&l(n)}).subscribe();return()=>{c.O.removeChannel(t)}},[e]),(0,s.useEffect)(()=>{(async()=>{if(!(null==o?void 0:o.mediaId)){u(""),v("none");return}try{let e=await fetch("".concat(x,"/media/").concat(o.mediaId,"/read-url?expires=600"));if(!e.ok){u(""),v("none");return}let t=await e.json();u((null==t?void 0:t.url)||""),v((null==t?void 0:t.type)||"none")}catch(e){u(""),v("none")}})()},[null==o?void 0:o.mediaId]);let p=async()=>{await fetch("".concat("http://localhost:8000/api","/screen/advance"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e})})};return(0,a.jsxs)("main",{className:"p-6 space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Tel\xe3o ao Vivo"}),(0,a.jsx)("div",{className:"space-y-2 max-w-md",children:(0,a.jsx)(i.I,{value:e,onChange:e=>t(e.target.value),placeholder:"eventId"})}),(0,a.jsx)("div",{className:"border rounded p-4 min-h-[300px] flex items-center justify-center bg-black text-white",children:o?(0,a.jsxs)("div",{className:"text-center w-full",children:[(0,a.jsxs)("div",{className:"text-sm mb-2",children:["M\xeddia: ",o.mediaId]}),(0,a.jsxs)("div",{className:"text-sm mb-4",children:["Dura\xe7\xe3o: ",o.durationSec,"s • Cr\xe9ditos: ",o.bidCredits]}),d&&"image"===m&&(0,a.jsx)("img",{src:d,alt:"",className:"mx-auto max-h-[60vh]"}),d&&"video"===m&&(0,a.jsx)("video",{src:d,controls:!0,className:"mx-auto max-h-[60vh]"}),d&&"audio"===m&&(0,a.jsx)("audio",{src:d,controls:!0,className:"mx-auto"}),!d&&(0,a.jsx)("div",{className:"text-xl",children:"Carregando m\xeddia…"})]}):(0,a.jsx)("div",{children:"Fila vazia"})}),(0,a.jsx)("div",{className:"flex gap-3",children:(0,a.jsx)(r.z,{onClick:p,children:"Avan\xe7ar"})})]})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var a=n(7437);function s(e){let{className:t="",...n}=e;return(0,a.jsx)("button",{className:"px-4 py-2 rounded bg-black text-white ".concat(t),...n})}},3102:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var a=n(7437);function s(e){let{className:t="",...n}=e;return(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2 ".concat(t),...n})}},1180:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});let a=(0,n(4593).eI)("https://jrwzpkavlaxcweodumak.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impyd3pwa2F2bGF4Y3dlb2R1bWFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwNDE1NzUsImV4cCI6MjA3ODYxNzU3NX0.vYt_DMqqU7dTI2Ad-Crv0AVstspSZjwqjFqE3sg8seo")}},function(e){e.O(0,[593,971,23,744],function(){return e(e.s=2133)}),_N_E=e.O()}]);